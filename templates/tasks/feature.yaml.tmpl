# 功能任务模板
# 统一使用 iter-N 格式：init-mode 填 "iter-0"，iterate-mode 填 "iter-N"（N≥1）

id: "{{TASK_ID}}"
type: "new_feature"
iteration: "{{ITERATION_ID}}"
title: "{{TITLE}}"
priority: "P1"           # P0(阻断) / P1(必须) / P2(可选)

# 功能描述（iterate-mode 建议填写，init-mode 可选）
description: |
  {{FEATURE_DESCRIPTION}}

# 集成点（iterate-mode 建议填写，init-mode 可选）
integration_points:
  - module: "{{MODULE_NAME}}"
    how: "{{HOW_TO_INTEGRATE}}"

# 数据流（可选）
data_flow: |
  {{DATA_FLOW_DESCRIPTION}}

# 技术方案（必须包含 why）
design:
  approach: |
    {{APPROACH_DESCRIPTION}}
  why_this_approach: |
    {{WHY_CHOSEN}}
  edge_cases:
    - scenario: "{{EDGE_CASE_1_SCENARIO}}"
      input: "{{EDGE_CASE_1_INPUT}}"
      expected: "{{EDGE_CASE_1_EXPECTED}}"
  config_params:
    - "{{CONFIG_KEY}}: {{CONFIG_VALUE}}  # {{COMMENT}}"

# 受影响文件（analyst 子代理填写）
affected_files:
  - "{{FILE_PATH_1}}"

# 验收标准（按维度分组，全部初始 FAIL）
acceptance_criteria:
  functional:
    - id: "{{TASK_ID}}-AC1"
      desc: "{{CRITERION_1}}"
      status: FAIL
    - id: "{{TASK_ID}}-AC2"
      desc: "{{CRITERION_2}}"
      status: FAIL
  # --- 以下维度按需填写（不适用的维度删除该行）---
  # robustness:
  #   - id: "{{TASK_ID}}-ACx"
  #     desc: "错误输入/边界条件处理正确"
  #     status: FAIL
  # performance:
  #   - id: "{{TASK_ID}}-ACx"
  #     desc: "响应时间/吞吐量符合要求"
  #     status: FAIL
  # ux_states: []        # UX 状态覆盖
  # ux_interaction: []   # UX 交互验收
  # security: []         # 安全验收
  # observability: []    # 可观测性验收

# 回归测试
regression_test: "运行全量 L1，结果 ≥ 基线"

# 状态（状态机: pending → in_progress → ready_for_verify → ready_for_review → PASS/rework/failed）
status: pending
current_step: null
owner: ""
retries: 0

# 依赖
depends: []

# 执行记录（developer/verifier/reviewer 子代理填写）
commits: []
notes: ""
decisions_ref: []
done_evidence:
  tests: []
  logs: []
  notes: []
review_result: null
